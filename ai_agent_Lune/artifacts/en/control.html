<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LuneScript Guide - Control Flow</title>
    <link rel="stylesheet" href="../style.css">
    <script src="../main.js" defer></script>
</head>

<body>
    <div class="sidebar">
        <h1>LuneScript Guide</h1>
        <ul class="nav-links">
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="index.html">Introduction</a>
                <ul class="submenu">
                    <li><a href="index.html#features">Key Features</a></li>
                    <li><a href="index.html#audience">Target Audience</a></li>
                    <li><a href="index.html#license">License</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="learning.html">Learning Guide</a>
                <ul class="submenu">
                    <li><a href="learning.html#step1">Step 1: Basics</a></li>
                    <li><a href="learning.html#step2">Step 2: Safety Features</a></li>
                    <li><a href="learning.html#step3">Step 3: Modern Features</a></li>
                    <li><a href="learning.html#navigation">Using Documentation</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="tutorial.html">Installation and Hello World</a>
                <ul class="submenu">
                    <li><a href="tutorial.html#install">Installation</a></li>
                    <li><a href="tutorial.html#hello">Hello World</a></li>
                    <li><a href="tutorial.html#options">lnsc Command</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="syntax.html">Basic Syntax</a>
                <ul class="submenu">
                    <li><a href="syntax.html#comments">Comments</a></li>
                    <li><a href="syntax.html#vars">Variable Declarations</a></li>
                    <li><a href="syntax.html#flow">Initialization by Flow Analysis</a></li>
                    <li><a href="syntax.html#scope">Scope Blocks</a></li>
                    <li><a href="syntax.html#attr">Attributes</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="value.html">Values and Types</a>
                <ul class="submenu">
                    <li><a href="value.html#primitive">Primitive Types</a></li>
                    <li><a href="value.html#collection">Collections</a></li>
                    <li><a href="value.html#list">&nbsp;&nbsp;List</a></li>
                    <li><a href="value.html#map">&nbsp;&nbsp;Map</a></li>
                    <li><a href="value.html#set">&nbsp;&nbsp;Set</a></li>
                    <li><a href="value.html#nilable">Nilable Types</a></li>
                    <li><a href="value.html#cast">Casting</a></li>
                    <li><a href="value.html#alge">Algebraic Data Types</a></li>
                    <li><a href="value.html#enum">Enum</a></li>
                    <li><a href="value.html#tuple">Tuple</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="control.html">Control Flow</a>
                <ul class="submenu">
                    <li><a href="control.html#if">if statement</a></li>
                    <li><a href="control.html#switch">switch statement</a></li>
                    <li><a href="control.html#while">while statement</a></li>
                    <li><a href="control.html#repeat">repeat statement</a></li>
                    <li><a href="control.html#for">for statement</a></li>
                    <li><a href="control.html#foreach">foreach statement</a></li>
                    <li><a href="control.html#apply">apply statement</a></li>
                    <li><a href="control.html#match">match statement</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="error.html">Error Handling</a>
                <ul class="submenu">
                    <li><a href="error.html#ret">__Ret Type</a></li>
                    <li><a href="error.html#delegation">Error Delegation</a></li>
                    <li><a href="error.html#best_practice">Types and Best Practices</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="function.html">Functions</a>
                <ul class="submenu">
                    <li><a href="function.html#def">Definition</a></li>
                    <li><a href="function.html#multi_ret">Multiple Returns</a></li>
                    <li><a href="function.html#closure">Closures</a></li>
                    <li><a href="function.html#form">Form (Function Type)</a></li>
                    <li><a href="function.html#varargs">Variable Arguments</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="class.html">Classes</a>
                <ul class="submenu">
                    <li><a href="class.html#def">Definition and Instantiation</a></li>
                    <li><a href="class.html#inherit">Inheritance and Overriding</a></li>
                    <li><a href="class.html#abstract">Abstract Classes</a></li>
                    <li><a href="class.html#interface">Interfaces</a></li>
                    <li><a href="class.html#advertise">Advertise</a></li>
                    <li><a href="class.html#mapping">Mapping</a></li>
                    <li><a href="class.html#proto">Prototype Declarations</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="generics.html">Generics</a>
                <ul class="submenu">
                    <li><a href="generics.html#func">Function Generics</a></li>
                    <li><a href="generics.html#class">Class Generics</a></li>
                    <li><a href="generics.html#constraint">Type Parameter Constraints</a></li>
                    <li><a href="generics.html#method">Method Generics</a></li>
                    <li><a href="generics.html#mut">Generics and Mutability</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="macro.html">Macros</a>
                <ul class="submenu">
                    <li><a href="macro.html#def">Definition</a></li>
                    <li><a href="macro.html#arg">Arguments</a></li>
                    <li><a href="macro.html#quote">Quoting</a></li>
                    <li><a href="macro.html#statement">Macro Statement</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="advanced.html">Advanced Features</a>
                <ul class="submenu">
                    <li><a href="advanced.html#match">Pattern Matching</a></li>
                    <li><a href="advanced.html#async">Asynchronous Processing</a></li>
                    <li><a href="advanced.html#glue">Glue Code</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="module.html">Modules and Projects</a>
                <ul class="submenu">
                    <li><a href="module.html#module">Module System</a></li>
                    <li><a href="module.html#project">Project Settings</a></li>
                    <li><a href="module.html#provide">Provide</a></li>
                    <li><a href="module.html#require">Require</a></li>
                    <li><a href="module.html#subfile">Subfile</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="standard.html">Standard Library</a>
                <ul class="submenu">
                    <li><a href="standard.html#builtin">Built-in Functions</a></li>
                    <li><a href="standard.html#lua">Lua Standard Library</a></li>
                    <li><a href="standard.html#io">IO</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="tutorial_macro.html">Practical: Macro Usage</a>
                <ul class="submenu">
                    <li><a href="tutorial_macro.html#step1">Step 1: Debug Print</a></li>
                    <li><a href="tutorial_macro.html#step2">Step 2: Assertion</a></li>
                    <li><a href="tutorial_macro.html#step3">Step 3: Measurement</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="tutorial_parser.html">Practical: Expression Parser</a>
                <ul class="submenu">
                    <li><a href="tutorial_parser.html#goal">Goal</a></li>
                    <li><a href="tutorial_parser.html#token">Step 1: Token Definition</a></li>
                    <li><a href="tutorial_parser.html#lexer">Step 2: Lexical Analysis</a></li>
                    <li><a href="tutorial_parser.html#ast">Step 3: Abstract Syntax Tree (AST)</a></li>
                    <li><a href="tutorial_parser.html#parser">Step 4: Parsing</a></li>
                    <li><a href="tutorial_parser.html#eval">Step 5: Evaluation and Execution</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="keyword.html">Keywords List</a>
                <ul class="submenu">
                    <li><a href="keyword.html#a">A-G</a></li>
                    <li><a href="keyword.html#h">H-N</a></li>
                    <li><a href="keyword.html#o">O-U</a></li>
                    <li><a href="keyword.html#v">V-Z</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="troubleshooting.html">Troubleshooting</a>
                <ul class="submenu">
                    <li><a href="troubleshooting.html#char">Character Literals</a></li>
                    <li><a href="troubleshooting.html#mut">Mutable Methods</a></li>
                    <li><a href="troubleshooting.html#match">Pattern Matching</a></li>
                    <li><a href="troubleshooting.html#unwrap">Nilable Operations</a></li>
                    <li><a href="troubleshooting.html#macro">Macro Syntax Errors</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="evaluation.html">Discussion and Evaluation</a>
                <ul class="submenu">
                    <li><a href="evaluation.html#quality">Language Quality</a></li>
                    <li><a href="evaluation.html#vs-lua">Comparison with Lua</a></li>
                    <li><a href="evaluation.html#vs-teal">Comparison with Teal</a></li>
                    <li><a href="evaluation.html#issues">Issues and Proposals</a></li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="main-content">
    <div class="header-nav">
        <a href="../ja/control.html" class="lang-link">日本語</a>
    </div>
        <h1>Control Flow</h1>
        <p>This section explains the syntax for describing program control flow in LuneScript.</p>

        <h2 id="if" id="keyword_if">if statement</h2>
        <p>Performs conditional branching. It can be followed by <code>elseif</code> or <code>else</code> blocks.</p>
        <pre><code class="language-lns"><span class="keyword">let</span> val = <span class="number">10</span>;
<span class="keyword">if</span> val == <span class="number">1</span> {
    print( <span class="string">"val is 1"</span> );
} <span class="keyword">elseif</span> val == <span class="number">10</span> {
    print( <span class="string">"val is 10"</span> );
} <span class="keyword">else</span> {
    print( <span class="string">"other"</span> );
}
</code></pre>
        <p>In LuneScript, if the result of an expression is <code>nil</code> or <code>false</code>, it is considered
            "failing". Otherwise, it is "passing".</p>
        <div class="note">
            Comparing <code>bool</code> values with <code>== true</code> or <code>== false</code> is not recommended.
            Use <code>if exp</code> or <code>if not exp</code> instead.
        </div>

        <h2 id="switch" id="keyword_switch">switch statement</h2>
        <p>Performs branching based on a value. Although Lua does not have this syntax, it is supported in LuneScript.
        </p>
        <pre><code class="language-lns"><span class="keyword">let</span> val = <span class="number">1</span>;
<span class="keyword">switch</span> val {
    <span class="keyword">case</span> <span class="number">1</span> {
        print( <span class="string">"One"</span> );
    }
    <span class="keyword">case</span> <span class="number">2</span>, <span class="number">3</span> { <span class="comment">// Multiple values can be specified</span>
        print( <span class="string">"Two or Three"</span> );
    }
    <span class="keyword">default</span> {
        print( <span class="string">"Other"</span> );
    }
}
</code></pre>
        <ul>
            <li>Multiple values can be specified in <code>case</code> separated by commas.</li>
            <li><code>break</code> is not required (automatically exits the block).</li>
            <li>The <code>default</code> clause describes the behavior when all cases are not covered.</li>
        </ul>
        <p><strong>Integration with Enum:</strong> When the conditional expression is an Enum value, the compiler checks
            if all cases are covered. If all cases are described, <code>default</code> is considered unreachable, and
            describing it results in a warning (use <code>_default</code> if you want to describe it as a fail-safe).
        </p>

        <h2 id="match" id="keyword_match">match statement</h2>
        <p>Performs pattern matching on <code>alge</code> type values, extracts values, and performs branching.</p>
        <pre><code class="language-lns"><span class="keyword">alge</span> Result {
    Val( <span class="type">int</span> ),
    Err( <span class="type">str</span> ),
}
<span class="keyword">fn</span> check( res: Result ) {
    <span class="keyword">match</span> res {
        <span class="keyword">case</span> .Val( val ) {
            print( <span class="string">"Success:"</span>, val );
        }
        <span class="keyword">case</span> .Err( msg ) {
            print( <span class="string">"Error:"</span>, msg );
        }
    }
}
</code></pre>
        <p>For more details on <code>alge</code> types, see the <a href="value.html#alge">Values and Types</a> chapter.
        </p>

        <h2 id="while" id="keyword_while">while statement</h2>
        <p>Repeats the loop as long as the condition is met.</p>
        <pre><code class="language-lns"><span class="keyword">let</span> <span class="keyword">mut</span> val = <span class="number">0</span>;
<span class="keyword">while</span> val < <span class="number">5</span> {
    print( val );
    val = val + <span class="number">1</span>;
}
</code></pre>
        <p>To create an infinite loop, use <code>while true { ... }</code>. This <code>true</code> must be a literal
            (constant variables are not allowed).</p>

        <h2 id="repeat" id="keyword_repeat">repeat statement</h2>
        <p>Repeats the loop until the condition is met (while it is not met). The condition is checked after the block
            is executed.</p>
        <pre><code class="language-lns"><span class="keyword">let</span> <span class="keyword">mut</span> val = <span class="number">0</span>;
<span class="keyword">repeat</span> {
    val = val + <span class="number">1</span>;
} val >= <span class="number">5</span>;
</code></pre>
        <p>Variables declared within the block can be used in the termination condition expression.</p>
        <p>* Note: <code>repeat</code> may be deprecated in the future.</p>

        <h2 id="for" id="keyword_for">for statement</h2>
        <p>Performs a loop over a range of numbers.</p>
        <pre><code class="language-lns"><span class="comment">// Increase from 1 to 10 by 1</span>
<span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">10</span> {
    print( i );
}

<span class="comment">// Decrease from 10 to 1 by -1</span>
<span class="keyword">for</span> i = <span class="number">10</span>, <span class="number">1</span>, -<span class="number">1</span> {
    print( i );
}
</code></pre>
        <p>The format is <code>for variable = start, end [, step] { ... }</code>. If the step is omitted, it defaults to
            1.</p>

        <h2 id="foreach" id="keyword_foreach">foreach statement</h2>
        <p>Iterates over the elements of a collection (List, Map, Set).</p>
        <pre><code class="language-lns"><span class="keyword">let</span> list = [ <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span> ];
<span class="keyword">foreach</span> val, index <span class="keyword">in</span> list {
    print( index, val ); <span class="comment">// 1 10, 2 20, 3 30</span>
}

<span class="keyword">let</span> map = { "a": 1, "b": 2 };
<span class="keyword">foreach</span> val, key <span class="keyword">in</span> map {
    print( key, val );
}
</code></pre>
        <ul>
            <li><code>List</code>: Receives values in the order <code>val, index</code>.</li>
            <li><code>Map</code>: Receives values in the order <code>val, key</code>.</li>
            <li><code>Set</code>: Receives only <code>val</code>.</li>
            <li>Index or key can be omitted if not needed: <code>foreach val in list { ... }</code></li>
            <li>The order of enumeration for Maps and Sets is undefined. If you want to guarantee order, use
                <code>forsort</code>.</li>
        </ul>

        <h2 id="apply" id="keyword_apply">apply statement</h2>
        <p>Used when using Lua iterator functions (equivalent to Lua's <code>for in</code>).</p>
        <pre><code class="language-lns"><span class="keyword">apply</span> txt <span class="keyword">of</span> string.gmatch( "a.b.c", "[^%.]+" ) {
    print( txt );
}
</code></pre>

    </div>
</body>

</html>