<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LuneScript Guide - Classes</title>
    <link rel="stylesheet" href="../style.css">
    <script src="../main.js" defer></script>
</head>

<body>
    <div class="sidebar">
        <h1>LuneScript Guide</h1>
        <ul class="nav-links">
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="index.html">Introduction</a>
                <ul class="submenu">
                    <li><a href="index.html#features">Key Features</a></li>
                    <li><a href="index.html#audience">Target Audience</a></li>
                    <li><a href="index.html#license">License</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="learning.html">Learning Guide</a>
                <ul class="submenu">
                    <li><a href="learning.html#step1">Step 1: Basics</a></li>
                    <li><a href="learning.html#step2">Step 2: Safety Features</a></li>
                    <li><a href="learning.html#step3">Step 3: Modern Features</a></li>
                    <li><a href="learning.html#navigation">Using Documentation</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="tutorial.html">Installation and Hello World</a>
                <ul class="submenu">
                    <li><a href="tutorial.html#install">Installation</a></li>
                    <li><a href="tutorial.html#hello">Hello World</a></li>
                    <li><a href="tutorial.html#options">lnsc Command</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="syntax.html">Basic Syntax</a>
                <ul class="submenu">
                    <li><a href="syntax.html#comments">Comments</a></li>
                    <li><a href="syntax.html#vars">Variable Declarations</a></li>
                    <li><a href="syntax.html#flow">Initialization by Flow Analysis</a></li>
                    <li><a href="syntax.html#scope">Scope Blocks</a></li>
                    <li><a href="syntax.html#attr">Attributes</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="value.html">Values and Types</a>
                <ul class="submenu">
                    <li><a href="value.html#primitive">Primitive Types</a></li>
                    <li><a href="value.html#collection">Collections</a></li>
                    <li><a href="value.html#list">&nbsp;&nbsp;List</a></li>
                    <li><a href="value.html#map">&nbsp;&nbsp;Map</a></li>
                    <li><a href="value.html#set">&nbsp;&nbsp;Set</a></li>
                    <li><a href="value.html#nilable">Nilable Types</a></li>
                    <li><a href="value.html#cast">Casting</a></li>
                    <li><a href="value.html#alge">Algebraic Data Types</a></li>
                    <li><a href="value.html#enum">Enum</a></li>
                    <li><a href="value.html#tuple">Tuple</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="control.html">Control Flow</a>
                <ul class="submenu">
                    <li><a href="control.html#if">if statement</a></li>
                    <li><a href="control.html#switch">switch statement</a></li>
                    <li><a href="control.html#while">while statement</a></li>
                    <li><a href="control.html#repeat">repeat statement</a></li>
                    <li><a href="control.html#for">for statement</a></li>
                    <li><a href="control.html#foreach">foreach statement</a></li>
                    <li><a href="control.html#apply">apply statement</a></li>
                    <li><a href="control.html#match">match statement</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="error.html">Error Handling</a>
                <ul class="submenu">
                    <li><a href="error.html#ret">__Ret Type</a></li>
                    <li><a href="error.html#delegation">Error Delegation</a></li>
                    <li><a href="error.html#best_practice">Types and Best Practices</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="function.html">Functions</a>
                <ul class="submenu">
                    <li><a href="function.html#def">Definition</a></li>
                    <li><a href="function.html#multi_ret">Multiple Returns</a></li>
                    <li><a href="function.html#closure">Closures</a></li>
                    <li><a href="function.html#form">Form (Function Type)</a></li>
                    <li><a href="function.html#varargs">Variable Arguments</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="class.html">Classes</a>
                <ul class="submenu">
                    <li><a href="class.html#def">Definition and Instantiation</a></li>
                    <li><a href="class.html#inherit">Inheritance and Overriding</a></li>
                    <li><a href="class.html#abstract">Abstract Classes</a></li>
                    <li><a href="class.html#interface">Interfaces</a></li>
                    <li><a href="class.html#advertise">Advertise</a></li>
                    <li><a href="class.html#mapping">Mapping</a></li>
                    <li><a href="class.html#proto">Prototype Declarations</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="generics.html">Generics</a>
                <ul class="submenu">
                    <li><a href="generics.html#func">Function Generics</a></li>
                    <li><a href="generics.html#class">Class Generics</a></li>
                    <li><a href="generics.html#constraint">Type Parameter Constraints</a></li>
                    <li><a href="generics.html#method">Method Generics</a></li>
                    <li><a href="generics.html#mut">Generics and Mutability</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="macro.html">Macros</a>
                <ul class="submenu">
                    <li><a href="macro.html#def">Definition</a></li>
                    <li><a href="macro.html#arg">Arguments</a></li>
                    <li><a href="macro.html#quote">Quoting</a></li>
                    <li><a href="macro.html#statement">Macro Statement</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="advanced.html">Advanced Features</a>
                <ul class="submenu">
                    <li><a href="advanced.html#match">Pattern Matching</a></li>
                    <li><a href="advanced.html#async">Asynchronous Processing</a></li>
                    <li><a href="advanced.html#glue">Glue Code</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="module.html">Modules and Projects</a>
                <ul class="submenu">
                    <li><a href="module.html#module">Module System</a></li>
                    <li><a href="module.html#project">Project Settings</a></li>
                    <li><a href="module.html#provide">Provide</a></li>
                    <li><a href="module.html#require">Require</a></li>
                    <li><a href="module.html#subfile">Subfile</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="standard.html">Standard Library</a>
                <ul class="submenu">
                    <li><a href="standard.html#builtin">Built-in Functions</a></li>
                    <li><a href="standard.html#lua">Lua Standard Library</a></li>
                    <li><a href="standard.html#io">IO</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="tutorial_macro.html">Practical: Macro Usage</a>
                <ul class="submenu">
                    <li><a href="tutorial_macro.html#step1">Step 1: Debug Print</a></li>
                    <li><a href="tutorial_macro.html#step2">Step 2: Assertion</a></li>
                    <li><a href="tutorial_macro.html#step3">Step 3: Measurement</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="tutorial_parser.html">Practical: Expression Parser</a>
                <ul class="submenu">
                    <li><a href="tutorial_parser.html#goal">Goal</a></li>
                    <li><a href="tutorial_parser.html#token">Step 1: Token Definition</a></li>
                    <li><a href="tutorial_parser.html#lexer">Step 2: Lexical Analysis</a></li>
                    <li><a href="tutorial_parser.html#ast">Step 3: Abstract Syntax Tree (AST)</a></li>
                    <li><a href="tutorial_parser.html#parser">Step 4: Parsing</a></li>
                    <li><a href="tutorial_parser.html#eval">Step 5: Evaluation and Execution</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="keyword.html">Keywords List</a>
                <ul class="submenu">
                    <li><a href="keyword.html#a">A-G</a></li>
                    <li><a href="keyword.html#h">H-N</a></li>
                    <li><a href="keyword.html#o">O-U</a></li>
                    <li><a href="keyword.html#v">V-Z</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="troubleshooting.html">Troubleshooting</a>
                <ul class="submenu">
                    <li><a href="troubleshooting.html#char">Character Literals</a></li>
                    <li><a href="troubleshooting.html#mut">Mutable Methods</a></li>
                    <li><a href="troubleshooting.html#match">Pattern Matching</a></li>
                    <li><a href="troubleshooting.html#unwrap">Nilable Operations</a></li>
                    <li><a href="troubleshooting.html#macro">Macro Syntax Errors</a></li>
                </ul>
            </li>
            <li class="nav-item">
                <button class="toggle-btn">▶</button>
                <a href="evaluation.html">Discussion and Evaluation</a>
                <ul class="submenu">
                    <li><a href="evaluation.html#quality">Language Quality</a></li>
                    <li><a href="evaluation.html#vs-lua">Comparison with Lua</a></li>
                    <li><a href="evaluation.html#vs-teal">Comparison with Teal</a></li>
                    <li><a href="evaluation.html#issues">Issues and Proposals</a></li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="main-content">
        <div class="header-nav">
            <a href="../ja/class.html" class="lang-link">日本語</a>
        </div>
        <h1>Classes</h1>
        <p>LuneScript supports class-based object-oriented programming.</p>

        <h2 id="def" id="keyword_class">Definition and Instantiation</h2>
        <p>Classes are defined with the <code>class</code> keyword and instantiated with <code>new</code>.</p>
        <pre><code class="language-lns"><span class="keyword">class MyClass {
    pri let val: int;
    
    // Constructor
    pub fn __init( val: int ) {
        self.val = val;
    }
    
    // Method
    pub fn func(): int {
        return self.val;
    }
}

let obj = new MyClass( 10 );
print( obj.func() ); // 10
</code></pre>
        <ul>
            <li><strong>Constructor:</strong> Defined with the name <code>__init</code>. All member variables must be
                initialized here.</li>
            <li><strong>self:</strong> Use <code>self</code> to refer to itself (the instance).</li>
            <li><strong>Access Control:</strong> <code>pub</code> (public), <code>pro</code> (protected - up to
                subclasses), <code>pri</code> (private), and <code>local</code> (within the module). The default is
                <code>pri</code>.
            </li>
        </ul>

        <h3 id="accessor">Accessors</h3>
        <p>Accessors can be automatically generated in the format <code>{getter, setter}</code> during member
            definition.</p>
        <pre><code class="language-lns"><span class="keyword">class Data {
    pri let mut val: int {pub, pub}; // getter=pub, setter=pub
    pub fn __init( val: int ) { self.val = val; }
}
let mut d = new Data( 1 );
</code></pre>

        <h4>$ Operator</h4>
        <p>To access an automatically generated getter, prepend <code>$</code> to the member name. This is
            <strong>syntactic sugar</strong> that is internally converted into a call to the
            <code>get_MemberName()</code> method.<br>
            For setter, a method named <code>set_MemberName</code> is generated.
        </p>
        <div class="note">
            <p><strong>Why not "properties"?</strong><br>
                LuneScript intentionally avoids "properties" (a style found in some languages where method calls look
                like direct access). This ensures that developers can clearly distinguish between a simple data
                assignment/reference and a method call with potential side effects directly in the source code.</p>
        </div>
        <pre><code class="language-lns"><span class="keyword">class Data {
    pri let mut val: int {pub, pub};
    pub fn __init( val: int ) { self.val = val; }
}
let mut d = new Data( 1 );
print( d.$val ); // Getter call ($ sign)
d.set_val( 20 ); // Setter call (set_MemberName)
print( d.$val );
</code></pre>

        <h4>Omitting Access Control</h4>
        <p>If a setter is not needed, omit the second specification or specify <code>non</code>.</p>
        <pre><code class="language-lns"><span class="keyword">class AccessorTest {
    pri let val1: int {pub};       // Getter only (no setter)
    pri let val2: int {pub, non}; // Same as above
}
</code></pre>

        <h4>Immutable Return Value</h4>
        <p>To make the return value of a getter immutable, append <code>&</code>.</p>
        <pre><code class="language-lns"><span class="keyword">class ListWrapper {
    pri let mut list: List&lt;int&gt; {pub&, pub};
}
// $list returns &List&lt;int&gt; (read-only), so it cannot be modified
</code></pre>

        <h2 id="inherit" id="keyword_extend">Inheritance and Overriding</h2>
        <p>Single inheritance is possible with <code>extend</code>. The <code>override</code> keyword is mandatory for
            overriding methods.</p>
        <pre><code class="language-lns"><span class="keyword">class Base {
    pub fn func() { print( "Base" ); }
}

class Sub extend Base {
    pub override fn func() {
        super(); // Parent class call
        print( "Sub" );
    }
}
</code></pre>
        <p>In a subclass constructor, <strong>you must call <code>super()</code> at the beginning.</strong></p>

        <h2 id="abstract" id="keyword_abstract">Abstract Classes</h2>
        <p>A class that has methods without implementation (<code>abstract fn</code>) must be defined as an
            <code>abstract class</code>.
        </p>
        <pre><code class="language-lns"><span class="keyword">abstract class Animal {
    pub abstract fn cry();
}
</code></pre>

        <h2 id="interface" id="keyword_interface">Interfaces</h2>
        <p>Interfaces can be used instead of multiple inheritance. Interfaces do not have implementations.</p>
        <pre><code class="language-lns"><span class="keyword">interface Runner {
    pub fn run();
}

class Dog extend (Runner) {
    pub fn run() { print( "Run!" ); }
}
</code></pre>
        <p>When implementing multiple interfaces, write it as <code>extend (IF1, IF2)</code>.</p>

        <h2 id="advertise" id="keyword_advertise">Advertise (Delegation)</h2>
        <p>A feature that exposes (delegates) the methods of a composed (contained) object as if they were its own.</p>
        <pre><code class="language-lns"><span class="keyword">class Inner {
    pub fn foo() { print("Inner.foo"); }
}
class Wrapper {
    pri let inner: Inner;
    advertise inner; // Expose public methods of inner as methods of Wrapper
}
</code></pre>

        <h2 id="mapping" id="keyword_mapping">Mapping</h2>
        <p>By declaring <code>extend (Mapping)</code>, reciprocal conversion with Map (JSON-like objects) becomes
            possible.</p>
        <pre><code class="language-lns"><span class="keyword">class User extend (Mapping) {
    let name: str {pub};
    let age: int {pub};
}

// Create from JSON (Map)
let user = unwrap User._fromMap( { "name": "John", "age": 20 } );
// Convert to Map
let map = user._toMap();
</code></pre>

        <h2 id="proto">Prototype Declarations</h2>
        <p>Used when writing the implementation of a method later (or in a separate file). Useful when mutual references
            are needed.</p>
        <pre><code class="language-lns"><span class="keyword">class Test {
    pub fn func(); // Declaration only
}
// Implementation
pub fn Test.func() {
    print( "impl" );
}
</code></pre>

    </div>
</body>

</html>