enum TestEnum {
  Val1,
  Val2,
  Val3,
}

macro _CreateEnumToString( enumName: sym ) {
  {
    let enumStr = ,,,,enumName;
    let funcName = "%s_toString" (enumStr);
    
    // 引数名を避けるために val ではなく v を使ってみる (あるいは無効な位置か確認)
    let s = `{
       fn ,,,funcName( v: ,,enumName ): str {
          match v {
             case .Val1 { return "Val1"; }
             case .Val2 { return "Val2"; }
             case .Val3 { return "Val3"; }
          }
       }
    };
  }
  ,,s
}

_CreateEnumToString( TestEnum );
print( TestEnum_toString( TestEnum.Val1 ) );
