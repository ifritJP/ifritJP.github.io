<!DOCTYPE html>
<html lang="ja-jp">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>10. Functions - tech</title>
<meta name="generator" content="Hugo 0.100.1" />
<link href="https://ifritjp.github.io/documentsindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://ifritjp.github.io/documents/en/lunescript/func/">
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/custom.css">
<script src="https://ifritjp.github.io/documents/js/bundle.js"></script>
<script src="https://ifritjp.github.io/documents/js/lnsSrcRun.js"></script>
<script src="https://ifritjp.github.io/documents/js/highlight_lns.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/highlight_lns.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script><style>
:root {}
</style>
<meta property="og:title" content="10. Functions" />
<meta property="og:description" content="This time, I will explain the functions of LuneScript.
Function definition The LuneScript function is defined as follows:
// @lnsFront: ok fn add_sub( val1:int, val2:int ): int, int { return val1 &#43; val2, val1 - val2; } print( add_sub( 1, 2 ) ); // 3, -1 The above example defines the following function:
Definition Function name add_sub First argument name val1 First argument type int Second argument name val2 Second argument type int First return type int Second return type int LuneScript can return multiple return values." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ifritjp.github.io/documents/en/lunescript/func/" /><meta property="article:section" content="LuneScript" />

<meta property="og:site_name" content="tech" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="10. Functions"/>
<meta name="twitter:description" content="This time, I will explain the functions of LuneScript.
Function definition The LuneScript function is defined as follows:
// @lnsFront: ok fn add_sub( val1:int, val2:int ): int, int { return val1 &#43; val2, val1 - val2; } print( add_sub( 1, 2 ) ); // 3, -1 The above example defines the following function:
Definition Function name add_sub First argument name val1 First argument type int Second argument name val2 Second argument type int First return type int Second return type int LuneScript can return multiple return values."/>
<meta itemprop="name" content="10. Functions">
<meta itemprop="description" content="This time, I will explain the functions of LuneScript.
Function definition The LuneScript function is defined as follows:
// @lnsFront: ok fn add_sub( val1:int, val2:int ): int, int { return val1 &#43; val2, val1 - val2; } print( add_sub( 1, 2 ) ); // 3, -1 The above example defines the following function:
Definition Function name add_sub First argument name val1 First argument type int Second argument name val2 Second argument type int First return type int Second return type int LuneScript can return multiple return values.">

<meta itemprop="wordCount" content="1044">
<meta itemprop="keywords" content="" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4708B8S6ES"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4708B8S6ES');
</script>
</head>
<body><div class="container"><header>
<h1>tech</h1>


[<a href="https://ifritjp.github.io/documents/en/">English</a>]

[<a href="https://ifritjp.github.io/documents/">Japanese</a>]

</header>
<div class="global-menu">
<nav>
<ul>
<li><a href="/documents/">Home</a></li>
<li><a href="https://ifritjp.github.io/blog2/public/">blog</a></li>
<li><a href="https://ifritjp.github.io/LuneScript-webFront/lnsc_web_frontend/for_fengari/">LuneScript on Web</a></li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>10. Functions</h1>

<p>
This time, I will explain the functions of LuneScript.</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Function definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>The LuneScript function is defined as follows:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
fn add_sub( val1:int, val2:int ): int, int {
   return val1 + val2, val1 - val2;
}
print( add_sub( 1, 2 ) ); // 3, -1</code></pre>
</div>
<p>
The above example defines the following function:</p>
<table>
<thead>
<tr>
<th>Definition</th>
<th></th>
<th class="align-right"></th>
</tr>
</thead>
<tbody>
<tr>
<td>Function name</td>
<td>add_sub</td>
<td class="align-right"></td>
</tr>
<tr>
<td>First argument name</td>
<td>val1</td>
<td class="align-right"></td>
</tr>
<tr>
<td>First argument type</td>
<td>int</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Second argument name</td>
<td>val2</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Second argument type</td>
<td>int</td>
<td class="align-right"></td>
</tr>
<tr>
<td>First return type</td>
<td>int</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Second return type</td>
<td>int</td>
<td class="align-right"></td>
</tr>
</tbody>
</table>
<p>
LuneScript can return multiple return values.</p>
<div id="outline-container-headline-2" class="outline-4">
<h4 id="headline-2">
Return value
</h4>
<div id="outline-text-headline-2" class="outline-text-4">
<p>
Use the return statement for the return value of the function.</p>
<p>
The function can return multiple values.</p>
<p>
See below for multi-valued return values.</p>
<p>
<a href="../multipleretval">../multipleretval</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Function that does not return
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>
Some functions do not return processing.</p>
<p>
Here is an example:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: error
fn func(): __ {
   while true {
   }
}
func();
print( 1 ); // error</code></pre>
</div>
<p>
In this example, <code class="verbatim">func()</code> is an infinite loop. Therefore, <code class="verbatim">func()</code> will not return any processing.</p>
<p>
To make this clear, the return type of <code class="verbatim">func()</code> is <code>__</code>. <code>__</code> indicates that it is a function that does not return processing.</p>
<p>
This tells us that the next <code class="verbatim">print()</code> statement after <code class="verbatim">func()</code> will not be processed, resulting in an error.</p>
<p>
Note that a function whose return type is <code>__</code> must not return processing.</p>
<p>
For example, if you break as follows, the process will be returned from <code class="verbatim">func()</code> because the loop will be broken. In such a case, an error will occur.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: error
fn func(val:int): __ {
   while true {
      if val == 1 {
         break;
      }
   }
}</code></pre>
</div>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
Variadic argument, return value
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>
Variadic arguments and return values can be used.</p>
<p>
See the following article for details.</p>
<p>
<a href="../arg">../arg</a></p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-2">
<h2 id="headline-5">
Definition location
</h2>
<div id="outline-text-headline-5" class="outline-text-2">
<p>
Functions can be defined wherever a statement can be written. Specifically, it can be defined in the block as follows.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
fn sub():int {
   let mut val = 0;
   {
      {
         fn func(): int {
            return 1;
         }
         val = val + func();
      }
      fn func(): int {
         return 2;
      }
      val = val + func();
   }
   fn func(): int {
      return 3;
   }
   return val + func();
}
print( sub() ); // 6</code></pre>
</div>
<p>
Functions with the same name can be defined in different scopes.</p>
</div>
</div>
<div id="outline-container-headline-6" class="outline-2">
<h2 id="headline-6">
Public function
</h2>
<div id="outline-text-headline-6" class="outline-text-2">
<p>
Functions, like variables, can be exposed to the outside world using pub.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
pub fn func(): int {
   return 1;
}</code></pre>
</div>
<p>
By specifying pub, it becomes a function that can be accessed from the outside.</p>
<p>
global is also available.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
global fn func(): int {
   return 1;
}</code></pre>
</div>
<p>
The global declaration of a function has the same restrictions as the global declaration of a variable.</p>
<p>
<strong>&#34;A function declared global is valid when the module that declares the function is imported.&#34;</strong></p>
<p>
External exposure of functions has the following restrictions:</p>
<p>
<strong>&#34;Externally exposed functions must be declared in the top-level scope of the script.&#34;</strong></p>
</div>
</div>
<div id="outline-container-headline-7" class="outline-2">
<h2 id="headline-7">
form type
</h2>
<div id="outline-text-headline-7" class="outline-text-2">
<p>
<strong>LuneScript can handle function objects as values. You can use form as the type of a special function object.</strong></p>
<p>
The following is an example of using form.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
fn test() {
   print( &#34;hoge&#34; );
}
fn sub( func:form ) {
  func();
}
sub( test ); // hoge</code></pre>
</div>
<p>
This example has the following configuration:</p>
<ul>
<li>Define function test</li>
<li>The function sub has an argument of type form</li>
<li>Execute sub with test as an argument</li>
</ul>
<p>This will run test inside sub and print hoge.</p>
<p>
The form type is treated as the following function.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: skip
fn func(...):... {}</code></pre>
</div>
<div id="outline-container-headline-8" class="outline-3">
<h3 id="headline-8">
Function type that can be assigned to form type
</h3>
<div id="outline-text-headline-8" class="outline-text-3">
<p>
As mentioned above, form is synonymous with <code>fn func(...):... {}</code>.</p>
<p>
Also, <code class="verbatim">...</code> represents zero or more =stem!=s.</p>
<p>
That is, functions with stem! Arguments can be assigned to form types, and functions with non-stem! Arguments cannot be assigned.</p>
<p>
If it can be assigned, the next call to func2 (nil) will call func (nil), which will result in incorrect behavior.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: error
fn func( val:int ) {
   print( val + 1 );
}
let func2:form = func;
func2( nil );</code></pre>
</div>
<p>
The following are examples of substitutable and non-substitutable cases.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: error
let form1:form = fn ( val1:stem! ) { };
let form2:form = fn ( val1:stem ) { };  // error
let form3:form = fn ( val1:stem!, val2:stem! ) { };
let form4:form = fn ( val1:stem!, val2:stem ) { }; // error</code></pre>
</div>
<p>
The above form1 and form3 can be assigned, and form2 and form4 cannot be assigned.</p>
</div>
</div>
<div id="outline-container-headline-9" class="outline-3">
<h3 id="headline-9">
form declaration
</h3>
<div id="outline-text-headline-9" class="outline-text-3">
<p>
As mentioned above, form can handle only some types of functions.</p>
<p>
To handle a function that cannot be handled by form, declare the form as follows.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
form funcform( val:int ):int;
fn sub( func:funcform ) {
   print( func( 1 ) + 1 );
}
sub( fn ( val:int ):int { return val + 1; } ); // 3</code></pre>
</div>
<p>
In this example, funcform is declared as form.</p>
<p>
The form declaration makes funcform a functional type with an int type val as an argument and an int type as a return value.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-10" class="outline-2">
<h2 id="headline-10">
anonymous function
</h2>
<div id="outline-text-headline-10" class="outline-text-2">
<p>
An anonymous function defines a function that has no name.</p>
<p>
The following is an example of an anonymous function.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
fn sub( func:form ) {
  func( 1 );
}
sub( fn ( val:stem! ) { print( val ); } );  // 1</code></pre>
</div>
<p>
This example defines the anonymous function <code>fn ( val:int ) { print( val ); }</code>.</p>
<p>
By passing this anonymous function as an argument to <code class="verbatim">sub()</code>, the anonymous function will be executed within <code class="verbatim">sub()</code>.</p>
<p>
Anonymous function declarations are expressions.</p>
</div>
</div>
<div id="outline-container-headline-11" class="outline-2">
<h2 id="headline-11">
Function call
</h2>
<div id="outline-text-headline-11" class="outline-text-2">
<p>
Adding <code>()</code> to a function object will execute that function.</p>
<p>
The types of the formal and actual arguments of the function must match. The omitted actual argument is treated as nil. If the formal argument corresponding to the omitted actual argument is not nilable, an error will occur.</p>
<div id="outline-container-headline-12" class="outline-3">
<h3 id="headline-12">
Omission of arguments
</h3>
<div id="outline-text-headline-12" class="outline-text-3">
<p>
Check the following article for omission of arguments.</p>
<p>
<a href="../defaultarg">../defaultarg</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-13" class="outline-2">
<h2 id="headline-13">
Function restrictions
</h2>
<div id="outline-text-headline-13" class="outline-text-2">
<p>
LuneScript functions cannot be overloaded due to different arguments.</p>
</div>
</div>
<div id="outline-container-headline-14" class="outline-2">
<h2 id="headline-14">
summary
</h2>
<div id="outline-text-headline-14" class="outline-text-2">
<p>
To summarize the LuneScript functions,</p>
<ul>
<li>Declare with fn</li>
<li>Can have multiple return values</li>
<li>Has variable length arguments and return values</li>
<li>Publish functions to external modules with pub, global</li>
<li>Function object types use form types and form declarations</li>
<li>There is an anonymous function</li>
<li>The omitted actual argument contains nil</li>
<li>No function overload</li>
</ul>
<p>Next time, I will talk about nilable.</p>
</div>
</div>
<div class="edit-meta">

<br></div><nav class="pagination"><a class="nav nav-prev-2" href="https://ifritjp.github.io/documents/en/lunescript/loop/" title="09. Repeated syntax"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - 09. Repeated syntax</a>
<a class="nav nav-next-2" href="https://ifritjp.github.io/documents/en/lunescript/multipleretval/" title="10.2. Multi-valued return value">Next - 10.2. Multi-valued return value <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">

<nav class="slide-menu">
<ul>
<li class=""><a href="https://ifritjp.github.io/documents">Home</a></li>

<li class="parent has-sub-menu"><a href="https://ifritjp.github.io/documents/en/lunescript/">Making Lua easier with the transcompiler LuneScript !!<span class="mark opened">-</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tutorial2.setup/">01. Introduction</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tutorial3.hello/">02. Hello world</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/crosscompile/">03. Cross-compiling between Lua versions</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/value/">04. Value</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/set/">04.2. Set</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/enum/">05. enum edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/match/">06. match edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/variable/">07. Variables</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/branch/">08. General branch syntax</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/loop/">09. Repeated syntax</a></li>
<li class="active"><a href="https://ifritjp.github.io/documents/en/lunescript/func/">10. Functions</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/multipleretval/">10.2. Multi-valued return value</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/defaultarg/">10.3. Omission of arguments</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/arg/">10.4. Variadic argument, return value</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/closure/">10.5. Closure</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/nilable/">11. nilable edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/class1/">12. Class Basics</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/class2accessor/">13. accessor edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classinherit/">14. Class inheritance</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classadvertise/">15. Class advertise</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classoverride/">16. Class override</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/interface/">17. Interface</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classmapping/">18. mapping</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/generics/">19. generics edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/nilcond/">20. nil conditional operator edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/import/">21. import / provide</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/require/">22. require / module edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/glue/">22.1. Semi-automatic generation of glue code</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lua/">22.2. Cooperation with Lua</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/make/">23. Build</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/macro/">24. Macro edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/cast/">25. Cast edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/subfile/">26. subfile edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lazyloading/">27. Delayed loading</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/shebang_main/">28. shebang and command line arguments</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/dir/">29. Recommended directory structure for projects that use LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go/">80. Transcompile to Go language</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_package/">80.2 Package when transcompiling to Go language</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lua_runtime/">80.3 Lua runtime when transcompiled to Go</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/async/">81. Safe asynchronous processing</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/async_old/">81.1 Asynchronous processing O (past information)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/luago/">82. Collaboration with Lua</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/completion/">A. Let&#39;s have more fun in an exciting development environment</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/onweb/">A. LuneScript running on a web browser</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lnstags/">A. Tag jump by lnstags (source code tag system)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/recommend/">A. Transcompiler development recommendations</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/reason/">A. Why Lua&#39;s transcompiler LuneScript was developed</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/box/">Box edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_study/">Transcompile to Z. Go language (under consideration)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/test/">X. Importance of self-hosting and test design in quality control of language development</a></li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
