<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>04. Values - tech</title>
<meta name="generator" content="Hugo 0.118.2">
<link href="https://ifritjp.github.io/documentsindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://ifritjp.github.io/documents/en/lunescript/value/">
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/custom.css">
<script src="https://ifritjp.github.io/documents/js/bundle.js"></script>
<script src="https://ifritjp.github.io/documents/js/lnsSrcRun.js"></script>
<script src="https://ifritjp.github.io/documents/js/highlight_lns.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/highlight_lns.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script><style>
:root {}
</style>
<meta property="og:title" content="04. Values" />
<meta property="og:description" content="This time, I will explain the values that can be handled by LuneScript. value type Here is a correspondence table between the value types that can be handled by LuneScript and the Lua values after the transcompiler. LuneScript Lua go Usage How to define in LuneScript nil, null nil nil nil nil int numerical value LnsInt integer 0 1 2 3 ?A 0x10 -100 real numerical value LnsReal real number" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ifritjp.github.io/documents/en/lunescript/value/" /><meta property="article:section" content="LuneScript" />

<meta property="og:site_name" content="公開技術情報" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="04. Values"/>
<meta name="twitter:description" content="This time, I will explain the values that can be handled by LuneScript. value type Here is a correspondence table between the value types that can be handled by LuneScript and the Lua values after the transcompiler. LuneScript Lua go Usage How to define in LuneScript nil, null nil nil nil nil int numerical value LnsInt integer 0 1 2 3 ?A 0x10 -100 real numerical value LnsReal real number"/>
<meta itemprop="name" content="04. Values">
<meta itemprop="description" content="This time, I will explain the values that can be handled by LuneScript. value type Here is a correspondence table between the value types that can be handled by LuneScript and the Lua values after the transcompiler. LuneScript Lua go Usage How to define in LuneScript nil, null nil nil nil nil int numerical value LnsInt integer 0 1 2 3 ?A 0x10 -100 real numerical value LnsReal real number">

<meta itemprop="wordCount" content="2434">
<meta itemprop="keywords" content="" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4708B8S6ES"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4708B8S6ES');
</script>
</head>
<body><div class="container"><header>
<h1>tech</h1>


[<a href="https://ifritjp.github.io/documents/en/">English</a>]

[<a href="https://ifritjp.github.io/documents/">Japanese</a>]

</header>
<div class="global-menu">
<nav>
<ul>
<li><a href="/documents/">Home</a></li>
<li><a href="https://ifritjp.github.io/blog2/public/">blog</a></li>
<li><a href="https://ifritjp.github.io/LuneScript-webFront/lnsc_web_frontend/for_wasm/">LuneScript on Web</a></li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>04. Values</h1>

<p>
This time, I will explain the values that can be handled by LuneScript.</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
value type
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>
Here is a correspondence table between the value types that can be handled by LuneScript and the Lua values after the transcompiler.</p>
<table>
<thead>
<tr>
<th>LuneScript</th>
<th>Lua</th>
<th>go</th>
<th>Usage</th>
<th>How to define in LuneScript</th>
<th class="align-right"></th>
</tr>
</thead>
<tbody>
<tr>
<td>nil, null</td>
<td>nil</td>
<td>nil</td>
<td>nil</td>
<td>nil</td>
<td class="align-right"></td>
</tr>
<tr>
<td>int</td>
<td>numerical value</td>
<td>LnsInt</td>
<td>integer</td>
<td>0 1 2 3 ?A 0x10 -100</td>
<td class="align-right"></td>
</tr>
<tr>
<td>real</td>
<td>numerical value</td>
<td>LnsReal</td>
<td>real number</td>
<td>0.0 1.0 0.001</td>
<td class="align-right"></td>
</tr>
<tr>
<td>str</td>
<td>string</td>
<td>string</td>
<td>string, binary data</td>
<td>&#34;abc&#34; &#39;def&#39;  ```hij```</td>
<td class="align-right"></td>
</tr>
<tr>
<td>bool</td>
<td>boolean</td>
<td>bool</td>
<td>boolean</td>
<td>true false</td>
<td class="align-right"></td>
</tr>
<tr>
<td>List</td>
<td>table</td>
<td>LnsList</td>
<td>list</td>
<td>[1, 2, 3 ]</td>
<td class="align-right"></td>
</tr>
<tr>
<td><del>Array</del></td>
<td><del>table</del></td>
<td><del>array (fixed length)</del></td>
<td><del>[@ 1, 2, 3 ]</del></td>
<td></td>
<td class="align-right"></td>
</tr>
<tr>
<td>Map</td>
<td>table</td>
<td>LnsMap</td>
<td>map</td>
<td>{ &#34;A&#34;:1, &#34;BC&#34;: 100 }</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Set</td>
<td>table</td>
<td>LnsSet</td>
<td>set</td>
<td>(@ 1, 2, 3)</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Tuple</td>
<td>table</td>
<td>[]LnsAny</td>
<td>tuple</td>
<td>(= 1, 2, 3)</td>
<td class="align-right"></td>
</tr>
<tr>
<td>class</td>
<td>table</td>
<td>struct</td>
<td>class</td>
<td>class Test {}</td>
<td class="align-right"></td>
</tr>
<tr>
<td>interface</td>
<td>table</td>
<td>interface</td>
<td>interface</td>
<td>interface Test {}</td>
<td class="align-right"></td>
</tr>
<tr>
<td>fn</td>
<td>function</td>
<td>func</td>
<td>function</td>
<td>fn func() {}</td>
<td class="align-right"></td>
</tr>
<tr>
<td>enum</td>
<td>number, string</td>
<td>const</td>
<td>enum</td>
<td>enum Test { }</td>
<td class="align-right"></td>
</tr>
<tr>
<td>alge</td>
<td>table</td>
<td>struct</td>
<td>algebraic data</td>
<td>alge Test { }</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Luaval</td>
<td>Lua value</td>
<td>Lns_luaValue</td>
<td>Lua value itself</td>
<td></td>
<td class="align-right"></td>
</tr>
<tr>
<td>stem</td>
<td>value</td>
<td>LnsAny</td>
<td>A type that can hold any non-nil value</td>
<td></td>
<td class="align-right"></td>
</tr>
</tbody>
</table>
<p>
<strong>2019/3 Set added. 2020/10 Luaval added 2023/1 Tuple added</strong></p>
<p>
As mentioned above, LuneScript subdivides Lua values and treats each as a separate type.</p>
<p>
The intention of the subdivision is to improve the following specifications of Lua.</p>
<ul>
<li>Numerical values in Lua are all real numbers, and if you are not used to it, problems due to the numerical values being real numbers will occur. For example, the Lua calculation result for <code>10/3</code> is 3.3333 instead of 3.</li>
<li>
<p>Lua tables are divided into sequences whose keys are all natural numbers and non-sequence whose keys are not natural numbers.</p>
<ul>
<li>
<p>Due to this difference, the functions for enumerating data in the table are divided into ipairs and pairs, and it is necessary to use them properly.</p>
<ul>
<li>Although it can be said that there is no problem if only pairs are used. . .</li>
</ul>
</li>
<li>The <code>#</code> operator to get the size of a table is confusing because it returns the size of sequences and not the size of non-sequences.</li>
</ul>
</li>
</ul>
<div id="outline-container-headline-2" class="outline-3">
<h3 id="headline-2">
nil
</h3>
<div id="outline-text-headline-2" class="outline-text-3">
<p>
nil is the same as nil in Lua.</p>
<p>
Null is also available in LuneScript.</p>
<p>
null is an alias for nil.</p>
<p>
Null support allows you to work with JSON as-is in LuneScript.</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
integer, real
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<p>
LuneScript treats integers and real numbers separately.</p>
<p>
So 10/3 becomes 3 and 10/3.0 becomes 3.3333…</p>
<p>
The model names are as follows.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let val:int = 1;      // 整数 int
let val2:real = 1.5;  // 実数 real</code></pre>
</div>
<div id="outline-container-headline-4" class="outline-4">
<h4 id="headline-4">
numeric literal
</h4>
<div id="outline-text-headline-4" class="outline-text-4">
<p>
C89-like numeric literals are used.</p>
<ul>
<li>Integers support decimal and hexadecimal representations</li>
<li>A real number is a decimal number and exponential representation by e.</li>
</ul>
</div>
</div>
<div id="outline-container-headline-5" class="outline-4">
<h4 id="headline-5">
letter
</h4>
<div id="outline-text-headline-5" class="outline-text-4">
<p>
Using <code>?</code> allows LuneScript to treat the code of the character following <code>?</code> as an immediate value of type int .</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( ?a ); // 97  (0x61)</code></pre>
</div>
<p>
Note that to get the code of a &#39; or &#34; character, you need to escape it with \ like ?\&#39; .</p>
<p>
Only one byte of code is available this way. For example, if the character following ? is a multi-byte code such as UTF-8, the first byte is acquired and the second and subsequent bytes are parsed as LuneScript code, resulting in a parse error.</p>
</div>
</div>
<div id="outline-container-headline-6" class="outline-4">
<h4 id="headline-6">
Four arithmetic operations
</h4>
<div id="outline-text-headline-6" class="outline-text-4">
<p>
The four arithmetic operations of numerical values adopt the same ones as Lua.</p>
<p>
The result of a binary operation changes type as follows:</p>
<ul>
<li>The operation result of int and int is int.</li>
<li>The operation result of real and real becomes real.</li>
<li>The result of an operation between int and real is real.</li>
</ul>
<p>However, if the operation result of int and int is outside the range of int, the internal value at runtime will be real, but the type in LuneScript will remain int. To round the result of an operation to an int, you need to cast with <code>@@int</code>.</p>
<p>
When transcompiled to go, it&#39;s still an int internally.</p>
</div>
</div>
<div id="outline-container-headline-7" class="outline-4">
<h4 id="headline-7">
bit operation
</h4>
<div id="outline-text-headline-7" class="outline-text-4">
<p>
Supports bitwise operations. Not available in Lua5.1.</p>
<p>
The bit length is 32bit in Lua5.2. The bit length of Lua5.3 depends on the environment.</p>
<ul>
<li>Logical AND (&amp;)</li>
</ul>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( 1 &amp; 3 == 1 );</code></pre>
</div>
<ul>
<li>Logical OR (|)</li>
</ul>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( 1 | 2 == 3 );</code></pre>
</div>
<ul>
<li>Exclusive OR (~)</li>
</ul>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( 1 ~ 3 == 2 );</code></pre>
</div>
<ul>
<li>Logical shift left (|&lt;&lt;)</li>
</ul>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( 1 |&lt;&lt; 2 == 4 );</code></pre>
</div>
<ul>
<li>Logical shift right (|&gt;&gt;)</li>
</ul>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( 0x10 |&gt;&gt; 2 == 4 );</code></pre>
</div>
<ul>
<li>Bit reversal (~)</li>
</ul>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( ~2 == 0xfffffffd );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-8" class="outline-3">
<h3 id="headline-8">
string
</h3>
<div id="outline-text-headline-8" class="outline-text-3">
<p>
If you surround it with &#34; or &#39;, it becomes a string. You can use &#39; inside &#34;&#34;, and you can use &#34; inside &#39;&#39;.</p>
<p>
Note that &#34;&#34;, &#39;&#39; cannot contain newlines. Use &#34; &#34; to include line breaks.</p>
<p>
  Use ``` to define a multi-line string without using . The characters in `````` are converted to strings as they are instead of newlines.</p>
<p>
Use [N] to get the character at a specific position in the string. The N specified here indicates 1 at the beginning of the string.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let txt = &#34;abc&#34;;
print( txt[ 2 ] );  // 98</code></pre>
</div>
<p>
<strong>The behavior is undefined if N exceeds the string length.</strong></p>
<p>
Get the string length with #.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( #&#34;abc&#34; ); // 3</code></pre>
</div>
<p>
The type name is str as follows.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let val:str = &#34;abc&#34;; // 文字列 str</code></pre>
</div>
<div id="outline-container-headline-9" class="outline-4">
<h4 id="headline-9">
Linking
</h4>
<div id="outline-text-headline-9" class="outline-text-4">
<p>
String concatenation is done with <code class="verbatim">..</code>.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( &#34;abc&#34; .. &#34;efg&#34; );  // abcdefg</code></pre>
</div>
</div>
</div>
<div id="outline-container-headline-10" class="outline-4">
<h4 id="headline-10">
format string
</h4>
<div id="outline-text-headline-10" class="outline-text-4">
<p>
You can generate a string by specifying the format below.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
print( &#34;%s %d %d&#34; (&#34;abc&#34;, 1, 2) ); // abc 1 2</code></pre>
</div>
<p>
Specify the value with () immediately after the string literal.</p>
<p>
See Lua&#39;s <code class="verbatim">string.format</code> API for information on formatting.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-11" class="outline-3">
<h3 id="headline-11">
boolean
</h3>
<div id="outline-text-headline-11" class="outline-text-3">
<p>
Has true and false.</p>
<p>
The type name is bool as follows:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let val:bool = true; // bool</code></pre>
</div>
</div>
</div>
<div id="outline-container-headline-12" class="outline-3">
<h3 id="headline-12">
list
</h3>
<div id="outline-text-headline-12" class="outline-text-3">
<p>
A list is a type that can add and remove values.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let mut list:List&lt;int&gt; = [];
list.insert( 1 ); // [ 1 ]
list.insert( 2 ); // [ 1, 2 ]
list.insert( 3 ); // [ 1, 2, 3 ]
list.remove(); // [ 1, 2 ]
print( list[1] ); // 1</code></pre>
</div>
<p>
<strong>Elements of the list are accessed by [index]. The index at the beginning of the list is 1. The behavior is undefined if you access outside the scope of the list.</strong></p>
<p>
<em><em>Original LuneScript was developed as a lua transcompiler, so//I focused on compatibility with lua and set the index from 1,//I now believe this was a failure. .</em></em></p>
<p>
It&#39;s <code>#</code> to get the length of the list. For example, <code>#list</code> gets the length of the list type variable list.</p>
<p>
Add value is <code class="verbatim">insert()</code> same as Lua, delete <code class="verbatim">remove()</code>.</p>
<p>
The type name is List&lt;T&gt; as follows: where T indicates the type of elements the list holds.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let val:List&lt;int&gt; = [1,2];</code></pre>
</div>
</div>
</div>
<div id="outline-container-headline-13" class="outline-3">
<h3 id="headline-13">
Map   
</h3>
<div id="outline-text-headline-13" class="outline-text-3">
<p>
Map literals are an extension of the JSON format.</p>
<p>
You can handle the JSON format like this:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let map = {
   &#34;val1&#34;: 1,
   &#34;val2&#34;: 2,
   &#34;val3&#34;: 3
};
print( map.val1, map.val2, map.val3 ); // 1 2 3</code></pre>
</div>
<p>
It differs from JSON in the following ways:</p>
<ul>
<li>All non-nil values are allowed for keys and values</li>
</ul>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let mut test:Map&lt;int,int&gt; = {};
let map = {
   1: &#34;val1&#34;,
   2.0: &#34;val2&#34;,
   test: &#34;val3&#34;
};
print( map[ 1 ], map[ 2.0 ], map[ test ] ); // val1 val2 val3</code></pre>
</div>
<p>
Also, since null is aliased to nil, JSON itself can be handled.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let mut map:Map&lt;str,int&gt; = {};
map[ &#34;abc&#34; ] = 1;
map.xyz = 10;</code></pre>
</div>
<p>
Elements of the Map are accessed by [key]. If key is of type str , it can also be accessed as .key .</p>
<p>
For example, [ &#34;abc&#34; ] and .abc access the same element, so print in the following example prints true .</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: skip
print( map[ &#34;abc&#34; ] == map.abc ); // true</code></pre>
</div>
<p>
Note that you cannot use the <code>#</code> operator on maps.</p>
<p>
The type name of Map is Map&lt;K,V&gt; as follows: where K is the key type and V is the value type associated with the key.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let val:Map&lt;str,int&gt; = { &#34;abc&#34;:123 };</code></pre>
</div>
<div id="outline-container-headline-14" class="outline-4">
<h4 id="headline-14">
Delete value
</h4>
<div id="outline-text-headline-14" class="outline-text-4">
<p>
As mentioned earlier, a Map cannot have nil values. By using this and setting the value to nil , we can remove it from the Map .</p>
<p>
For example, the following will set abc to nil for val with 123 registered for key &#34;abc&#34;: This will remove abc from val.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let val:Map&lt;str,int&gt; = { &#34;abc&#34;:123 };
val.abc = nil;
let mut total = 0;
foreach _ in val {
    total = total + 1;
}
print( total ); // 1</code></pre>
</div>
</div>
</div>
<div id="outline-container-headline-15" class="outline-4">
<h4 id="headline-15">
a set of nilables
</h4>
<div id="outline-text-headline-15" class="outline-text-4">
<p>
Assigning non-nil nilable values to Map is discouraged. It will be an error in the future.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let val:Map&lt;str,int&gt; = { &#34;abc&#34;:123 };
fn func( work:int! ) {
   val.abc = work;  // warrning
}
func( 1 );</code></pre>
</div>
<p>
This is because setting a Map to nilable makes it ambiguous whether it is a set of values or a deletion.</p>
<p>
Note that setting immediate to nil itself will still be supported.</p>
</div>
</div>
<div id="outline-container-headline-16" class="outline-4">
<h4 id="headline-16">
Notes on Maps
</h4>
<div id="outline-text-headline-16" class="outline-text-4">
<p>
Note the following when working with Maps:</p>
<div id="outline-container-headline-17" class="outline-5">
<h5 id="headline-17">
Map keys cannot distinguish between int and real .
</h5>
<div id="outline-text-headline-17" class="outline-text-5">
<p>
<strong>Specifically, it is undefined what <code>map[1]</code> and <code>map[1.0]</code> return in the example below.</strong></p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let map = {
   1: &#34;val1&#34;,
   1.0: &#34;val2&#34;,
};
print( map[ 1 ], map[ 1.0 ] );</code></pre>
</div>
<p>
This is a limitation from the Lua specification.</p>
<p>
Note that int and real are distinguished when transcompiled to go.</p>
</div>
</div>
<div id="outline-container-headline-18" class="outline-5">
<h5 id="headline-18">
Key equivalence judgment when using keys other than int, real, str
</h5>
<div id="outline-text-headline-18" class="outline-text-5">
<p>
In the following example, both list1 and list2 are lists with int 1 as an element. Using this list1 as a key, register &#34;aaa&#34; in map.</p>
<p>
And if you get values from map with list1, list2 as keys, the result will be aaa and nil .</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let mut map:Map&lt;&amp;List&lt;int&gt;,str&gt; = {};
let list1 = [ 1 ];
let list2 = [ 1 ];
map[ list1 ] = &#34;aaa&#34;;
print( map[ list1 ], map[ list2 ] );  // aaa nil</code></pre>
</div>
<p>
This is because list1 and list2 are determined as different keys.</p>
<p>
If you use anything other than int, real, or str as a map key, the keys must be the same object for equality.</p>
</div>
</div>
<div id="outline-container-headline-19" class="outline-5">
<h5 id="headline-19">
nilable
</h5>
<div id="outline-text-headline-19" class="outline-text-5">
<p>
As mentioned earlier, accessing the elements of a Map can be done like this:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let map = {
   &#34;val1&#34;: 1,
   &#34;val2&#34;: 2,
   &#34;val3&#34;: 3
};
print( map.val1, map.val2, map.val3 ); // 1 2 3</code></pre>
</div>
<p>
<strong>Here, map.val1 becomes nilable and cannot be treated as 1 of int which is original data as it is.</strong></p>
<p>
In other words, you cannot run <code class="verbatim">map.val1 + 1</code> like this:</p>
<pre class="example">
print( map.val1 +1 )
</pre>
<p>
For nilable see below.</p>
<p>
<a href="../nilable">../nilable</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-20" class="outline-3">
<h3 id="headline-20">
Set
</h3>
<div id="outline-text-headline-20" class="outline-text-3">
<p>
Handles a set of values.</p>
<p>
See the following article for details.</p>
<p>
<a href="../set/">../set/</a></p>
</div>
</div>
<div id="outline-container-headline-21" class="outline-3">
<h3 id="headline-21">
Tuple
</h3>
<div id="outline-text-headline-21" class="outline-text-3">
<p>
Handles value combinations.</p>
<p>
See the following article for details.</p>
<p>
<a href="../tuple/">../tuple/</a></p>
</div>
</div>
<div id="outline-container-headline-22" class="outline-3">
<h3 id="headline-22">
generics
</h3>
<div id="outline-text-headline-22" class="outline-text-3">
<p>
List, Array and Map support generics.</p>
<p>
For example, declare each of the following:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let list:List&lt;int&gt; = [];  // int を要素に持つリスト
let array:Array&lt;real&gt; = [@];  // real を要素に持つ配列
let map:Map&lt;str,int&gt; = {}; // str をキー、int を値に持つマップ</code></pre>
</div>
</div>
</div>
<div id="outline-container-headline-23" class="outline-3">
<h3 id="headline-23">
collection type
</h3>
<div id="outline-text-headline-23" class="outline-text-3">
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let list = [ 1, 2, 3 ];
let map = { &#34;A&#34;: 10, &#34;B&#34;: 11, &#34;C&#34;: 12 };</code></pre>
</div>
<p>
Collections such as lists and maps can declare literals as shown above. The type of list and map generated at this time is determined by the configured value.</p>
<p>
If the values used in a collection&#39;s constructor are all of the same type, the collection&#39;s type is that value&#39;s type.</p>
<p>
For example, <code>[ 1, 2, 3 ]</code> in the above sample becomes <code class="verbatim">List&lt;int&gt;</code>.</p>
<p>
If the values used in the collection&#39;s constructor are different, then the collection&#39;s type is stem .</p>
<p>
Specifically:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let list1 = [ 1, 2, 3 ];			// List&lt;int&gt;
let list2 = [ &#39;a&#39;, &#39;b&#39;, &#39;c&#39; ];			// List&lt;str&gt;
let list3 = [ &#39;a&#39;, 1, &#39;c&#39; ];			// List&lt;stem&gt;
let map1 = { &#34;A&#34;: 10, &#34;B&#34;: 11, &#34;C&#34;: 12 };	// Map&lt;str,int&gt;
let map2 = { &#34;A&#34;: 10, &#34;B&#34;: 11, &#34;C&#34;: 12 };	// Map&lt;str,int&gt;
let map3 = { &#34;a&#34;: &#39;z&#39;, &#34;b&#34;: &#39;y&#39;, &#34;c&#34;: &#39;x&#39; };	// Map&lt;str,str&gt;
let map4 = { &#34;a&#34;: 1, &#34;b&#34;: &#39;Z&#39; };		// Map&lt;str,stem&gt;</code></pre>
</div>
</div>
</div>
<div id="outline-container-headline-24" class="outline-3">
<h3 id="headline-24">
Constructor of a collection containing multiple classes with inheritance relationships
</h3>
<div id="outline-text-headline-24" class="outline-text-3">
<p>
Constructors of collections that include multiple classes with inheritance relationships may cause an error due to inability to resolve type inference.</p>
<p>
If so, please specify the type.</p>
<p>
Here is a sample:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: error
class Test {
}
class Sub extend Test {
}
{
   let mut val1 = [ [ new Test() ], [ new Sub() ] ]; // error
   let mut val2:List&lt;List&lt;Test&gt;&gt; = [ [ new Test() ], [ new Sub() ] ]; // ok
   let mut val3 = [ [ new Test() ], [ new Test() ] ]; // ok
   let mut val4 = [ [ new Sub() ], [ new Sub() ] ]; // ok
}</code></pre>
</div>
<p>
Here, val1 using type inference is an error. On the other hand, val2 with an explicit type is OK. Since val3 and val4 do not mix classes, they can be type inferred.</p>
</div>
</div>
<div id="outline-container-headline-25" class="outline-3">
<h3 id="headline-25">
enum
</h3>
<div id="outline-text-headline-25" class="outline-text-3">
<p>
LuneScript supports enums.</p>
<p>
See the article linked below for details.</p>
<p>
<a href="../enum/">../enum/</a></p>
</div>
</div>
<div id="outline-container-headline-26" class="outline-3">
<h3 id="headline-26">
Luaval
</h3>
<div id="outline-text-headline-26" class="outline-text-3">
<p>
LuneScript can execute Lua code. Execution results of Lua code convert int, real, bool and str internally, but other values are treated as Lua values without conversion.</p>
<p>
Luaval holds the value of that Lua.</p>
<p>
See below for details.</p>
<p>
<a href="../lua/">../lua/</a></p>
</div>
</div>
<div id="outline-container-headline-27" class="outline-3">
<h3 id="headline-27">
stem
</h3>
<div id="outline-text-headline-27" class="outline-text-3">
<p>
A stem is a type that can hold any non-nil value.</p>
<p>
LuneScript is a statically typed language, and if you give a value different from the expected type, you will get a compilation error.</p>
<p>
On the other hand, the stem type is a type that can handle all types other than nil, so no compilation error will occur even if any value other than nil is given.</p>
<p>
stem! is a type that can handle all values including nil. There is no problem in thinking that it is a Lua variable itself.</p>
<p>
Note that once converted to the stem type, a cast is required to convert back to the original type.</p>
<p>
Please refer to the following link for casting.</p>
<p>
<a href="../cast/">../cast/</a></p>
</div>
</div>
<div id="outline-container-headline-28" class="outline-3">
<h3 id="headline-28">
form
</h3>
<div id="outline-text-headline-28" class="outline-text-3">
<p>
form is a type that handles function objects.</p>
<p>
We&#39;ll talk about functions later.</p>
</div>
</div>
</div>
</div>
<div class="edit-meta">

<br></div><nav class="pagination"><a class="nav nav-prev-2" href="https://ifritjp.github.io/documents/en/lunescript/crosscompile/" title="03. Cross-compiling between Lua versions"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - 03. Cross-compiling between Lua versions</a>
<a class="nav nav-next-2" href="https://ifritjp.github.io/documents/en/lunescript/set/" title="04.2. Set">Next - 04.2. Set <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">

<nav class="slide-menu">
<ul>
<li class=""><a href="https://ifritjp.github.io/documents">Home</a></li>

<li class="parent has-sub-menu"><a href="https://ifritjp.github.io/documents/en/lunescript/">Easier Lua development with the transcompiler LuneScript!!<span class="mark opened">-</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tutorial2.setup/">01. Introduction</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tutorial3.hello/">02. Hello world</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/crosscompile/">03. Cross-compiling between Lua versions</a></li>
<li class="active"><a href="https://ifritjp.github.io/documents/en/lunescript/value/">04. Values</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/set/">04.2. Set</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tuple/">04.3 Tuples</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/enum/">05. enum</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/match/">06. match</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/variable/">07. Variables</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/branch/">08. General branch syntax</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/loop/">09. Repetition Syntax</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/func/">10. Functions</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/multipleretval/">10.2. Multi-value return values</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/defaultarg/">10.3. Omitting Arguments</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/arg/">10.4. Variadic Arguments and Return Values</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/closure/">10.5. Closures</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/error/">10.6. Error handling</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/nilable/">11. nilable</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/class1/">12. Class basics</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/class2accessor/">13. accessor</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classinherit/">14. Class Inheritance</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classadvertise/">15. Class advertise</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classoverride/">16. Class override</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/interface/">17. Interface</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classmapping/">18. mapping</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/generics/">19. generics</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/generics-go/">19.2. generics (two collection types)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/nilcond/">20. nil conditional operator</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/import/">21. import/provide</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/require/">22. require/module</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/glue/">22.1. Semi-automatic generation of glue code</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lua/">22.2. Linking with Lua</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/make/">23. Build</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/macro/">24. Macro</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/cast/">25. Cast</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/subfile/">26. subfile</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lazyloading/">27. Lazy Loading</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/shebang_main/">28. shebang and command line arguments</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/dir/">29. Recommended directory structure for projects using LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go/">80. Transcompiling to Go Language</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_package/">80.2 Packages when transpiling to Go</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_wasm/">80.4 WebAssembly support for LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/async/">81. Safe Asynchronous Processing</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/async_old/">81.1 Asynchronous processing (past information)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/luago/">82. Linking with Lua</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/ebnf/">A. BNF</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/onweb/">A. LuneScript running on a web browser</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/reason/">A. Reason for developing Lua transcompiler LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/recommend/">A. Recommendations for transcompiler development</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lnstags/">A. Tag jumping with lnstags (source code tagging system)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/completion/">A.Let&#39;s have more fun in a modern development environment</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/box/">Box edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lua_runtime/">Lua runtime when transpiling to 80.3 Go</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/test/">X. The Importance of Self-Hosting and Test Design in Language Development Quality Control</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/design/">Y.1 How to develop LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/design-2/">Y.2 Development of LuneScript (type information management)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/design-3/">Y.3 LuneScript Development (Scopes and Symbols)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_study/">Z. Transcompile to Go language (exploratory stage)</a></li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
