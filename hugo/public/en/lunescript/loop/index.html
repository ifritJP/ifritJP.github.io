<!DOCTYPE html>
<html lang="ja-jp">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>09. Repetition Syntax - tech</title>
<meta name="generator" content="Hugo 0.109.0">
<link href="https://ifritjp.github.io/documentsindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://ifritjp.github.io/documents/en/lunescript/loop/">
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/custom.css">
<script src="https://ifritjp.github.io/documents/js/bundle.js"></script>
<script src="https://ifritjp.github.io/documents/js/lnsSrcRun.js"></script>
<script src="https://ifritjp.github.io/documents/js/highlight_lns.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/highlight_lns.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script><style>
:root {}
</style>
<meta property="og:title" content="09. Repetition Syntax" />
<meta property="og:description" content="This time I will explain the repeat syntax of LuneScript.
Syntax list LuneScript supports the following repeat syntaxes:
while repeat (to be removed in the future) for apply foreach forsort while, repeat Use while, repeat like this:
// @lnsFront: ok let mut val = 1; while val &lt; 10 { val = val &#43; 1; } print( val ); // 10 repeat { let mut endFlag = false; val = val &#43; 1; if val &gt;= 20 { endFlag = true; } } endFlag; print( val ); // 20 while will process the block while the expression is true, and repeat will process the block while the expression is false." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ifritjp.github.io/documents/en/lunescript/loop/" /><meta property="article:section" content="LuneScript" />

<meta property="og:site_name" content="tech" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="09. Repetition Syntax"/>
<meta name="twitter:description" content="This time I will explain the repeat syntax of LuneScript.
Syntax list LuneScript supports the following repeat syntaxes:
while repeat (to be removed in the future) for apply foreach forsort while, repeat Use while, repeat like this:
// @lnsFront: ok let mut val = 1; while val &lt; 10 { val = val &#43; 1; } print( val ); // 10 repeat { let mut endFlag = false; val = val &#43; 1; if val &gt;= 20 { endFlag = true; } } endFlag; print( val ); // 20 while will process the block while the expression is true, and repeat will process the block while the expression is false."/>
<meta itemprop="name" content="09. Repetition Syntax">
<meta itemprop="description" content="This time I will explain the repeat syntax of LuneScript.
Syntax list LuneScript supports the following repeat syntaxes:
while repeat (to be removed in the future) for apply foreach forsort while, repeat Use while, repeat like this:
// @lnsFront: ok let mut val = 1; while val &lt; 10 { val = val &#43; 1; } print( val ); // 10 repeat { let mut endFlag = false; val = val &#43; 1; if val &gt;= 20 { endFlag = true; } } endFlag; print( val ); // 20 while will process the block while the expression is true, and repeat will process the block while the expression is false.">

<meta itemprop="wordCount" content="859">
<meta itemprop="keywords" content="" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4708B8S6ES"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4708B8S6ES');
</script>
</head>
<body><div class="container"><header>
<h1>tech</h1>


[<a href="https://ifritjp.github.io/documents/en/">English</a>]

[<a href="https://ifritjp.github.io/documents/">Japanese</a>]

</header>
<div class="global-menu">
<nav>
<ul>
<li><a href="/documents/">Home</a></li>
<li><a href="https://ifritjp.github.io/blog2/public/">blog</a></li>
<li><a href="https://ifritjp.github.io/LuneScript-webFront/lnsc_web_frontend/for_fengari/">LuneScript on Web</a></li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>09. Repetition Syntax</h1>

<p>
This time I will explain the repeat syntax of LuneScript.</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Syntax list
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>
LuneScript supports the following repeat syntaxes:</p>
<ul>
<li>while</li>
<li>repeat (to be removed in the future)</li>
<li>for</li>
<li>apply</li>
<li>foreach</li>
<li>forsort  </li>
</ul>
<div id="outline-container-headline-2" class="outline-3">
<h3 id="headline-2">
while, repeat
</h3>
<div id="outline-text-headline-2" class="outline-text-3">
<p>
Use while, repeat like this:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let mut val = 1;
while val &lt; 10 {
   val = val + 1;
}
print( val ); // 10
repeat {
   let mut endFlag = false;
   val = val + 1;
   if val &gt;= 20 {
      endFlag = true;
   }
} endFlag;
print( val ); // 20</code></pre>
</div>
<p>
while will process the block while the expression is true, and repeat will process the block while the expression is false.</p>
<p>
A repeat expression can make use of variables scoped inside the block.</p>
<p>
<strong>Note that repeat will be removed in the future.</strong></p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
infinite loop
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<p>
Use while true {} for infinite loops. Here true should be an immediate value.</p>
<p>
For example, if a variable is used instead of an immediate value as shown below, it will loop infinitely in terms of processing, but it will not be treated as an infinite loop in flow analysis.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: skip
let flag = true;
while flag {
}</code></pre>
</div>
<p>
The problem with not being regarded as an infinite loop is that the intended flow analysis cannot be performed.</p>
<p>
For example, LuneScript determines that the <code class="verbatim">print()</code> statement after an infinite loop is not processed if:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: error
while true {
}
print( &#34;hoge&#34; );</code></pre>
</div>
<p>
However, if the above true is not the immediate value, then it is determined that it is not an infinite loop and the <code class="verbatim">print()</code> statement may be processed.</p>
<p>
If something that should not be processed is judged as processed, what should be a compilation error will not become an error, and there is a possibility that a defect in the code will be overlooked.</p>
<p>
Always use immediate true for infinite loops.</p>
<p>
Note that repeat {} false is also not treated as an infinite loop.</p>
<p>
I thought it would be better to prepare an instruction dedicated to infinite loops like Rust, but the current specification is this.</p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-3">
<h3 id="headline-4">
for
</h3>
<div id="outline-text-headline-4" class="outline-text-3">
<p>
Use it like this:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
for count = 1, 10, 1 {
  print( count );
}</code></pre>
</div>
<p>
It is basically the same specification as Lua. The above example increments count from 1 to 10 by 1 and processes the block.</p>
<p>
Note that the values 1, 10, 1 are only evaluated once at the start of for .</p>
<p>
In other words, doing something like the following will not work as expected:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
let mut addVal = 1;
for count = 1, 10, addVal {
  addVal = addVal + 1;
  print( count );
}</code></pre>
</div>
<p>
<strong>If the increment value is omitted, 1 will be used.</strong></p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-3">
<h3 id="headline-5">
apply
</h3>
<div id="outline-text-headline-5" class="outline-text-3">
<p>
apply is a compatibility instruction with Lua&#39;s for in.</p>
<p>
Use it like this:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
apply txt of string.gmatch( &#34;hoge.foo.bar&#34;, &#39;[^%.]+&#39; ) {
   print( txt );
}</code></pre>
</div>
<p>
Note that the expression given to exp in <code>apply val of exp {}</code> must be a function call. This is a current limitation.</p>
</div>
</div>
<div id="outline-container-headline-6" class="outline-3">
<h3 id="headline-6">
foreach
</h3>
<div id="outline-text-headline-6" class="outline-text-3">
<p>
foreach is a function that enumerates the elements of lists, arrays and maps.</p>
<p>
Use it like this:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
foreach val, index in [ 1, 2, 3 ] {
   print( index, val );
}
foreach val, index in [@ 10, 20, 30 ] {
   print( index, val );
}
foreach val, key in { &#34;a&#34;:100, &#34;b&#34;:200, &#34;c&#34;:300 } {
   print( key, val );
}
foreach val in (@ 1, 2, 3 ) {
   print( val );
}</code></pre>
</div>
<p>
<strong>Set only enumerates values</strong></p>
<p>
List, array index, and map key can be omitted as follows.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
foreach val in [ 1, 2, 3 ] {
   print( val );
}
foreach val in [@ 10, 20, 30 ] {
   print( val );
}
foreach val in { &#34;a&#34;:100, &#34;b&#34;:200, &#34;c&#34;:300 } {
   print( val );
}</code></pre>
</div>
<p>
<strong>It is prohibited to change the enumerated objects during loop processing of foreach and forsort. If changed, the behavior is undefined.</strong></p>
<p>
For example, the following are prohibited:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: skip
let mut list = [ 1, 2, 3 ];
foreach val, index in list {
   list[ index ] = val + 10;
}</code></pre>
</div>
</div>
</div>
<div id="outline-container-headline-7" class="outline-3">
<h3 id="headline-7">
forsort
</h3>
<div id="outline-text-headline-7" class="outline-text-3">
<p>
<strong>If the elements of Set or Map are enumerated by foreach, the enumeration order of the elements is undefined.</strong></p>
<p>
forsort enumerates the elements of Set and Map in the order sorted by key (ascending order).</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
forsort val, key in { &#34;b&#34;:200, &#34;c&#34;:300, &#34;a&#34;:100 } {
   print( key, val );
}
forsort val in (@ 2, 4, 1, 0 ) {
   print( val );
}</code></pre>
</div>
<p>
Map&#39;s forsort can omit the key.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
forsort val in { &#34;b&#34;:200, &#34;c&#34;:300, &#34;a&#34;:100 } {
   print( val );
}</code></pre>
</div>
<p>
<strong>forsort internally clones and sorts, so there is overhead for that.</strong></p>
<p>
Also, if the type of the Set , or the key type of the Map is not a sortable type, an error will occur.</p>
</div>
</div>
<div id="outline-container-headline-8" class="outline-3">
<h3 id="headline-8">
break
</h3>
<div id="outline-text-headline-8" class="outline-text-3">
<p>
break exits the innermost repeat control statement.</p>
<p>
There is no continue.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-9" class="outline-2">
<h2 id="headline-9">
summary
</h2>
<div id="outline-text-headline-9" class="outline-text-2">
<p>
LuneScript&#39;s general control syntax is basically the same as Lua&#39;s.</p>
<p>
The main difference is the addition of foreach, forsort to handle lists etc.</p>
<p>
I&#39;ll explain the functions next time.</p>
</div>
</div>
<div class="edit-meta">

<br></div><nav class="pagination"><a class="nav nav-prev-2" href="https://ifritjp.github.io/documents/en/lunescript/branch/" title="08. General branch syntax"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - 08. General branch syntax</a>
<a class="nav nav-next-2" href="https://ifritjp.github.io/documents/en/lunescript/func/" title="10. Functions">Next - 10. Functions <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">

<nav class="slide-menu">
<ul>
<li class=""><a href="https://ifritjp.github.io/documents">Home</a></li>

<li class="parent has-sub-menu"><a href="https://ifritjp.github.io/documents/en/lunescript/">Easier Lua development with the transcompiler LuneScript!!<span class="mark opened">-</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tutorial2.setup/">01. Introduction</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tutorial3.hello/">02. Hello world</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/crosscompile/">03. Cross-compiling between Lua versions</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/value/">04. Values</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/set/">04.2. Set</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tuple/">04.3 Tuples</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/enum/">05. enum</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/match/">06. match</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/variable/">07. Variables</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/branch/">08. General branch syntax</a></li>
<li class="active"><a href="https://ifritjp.github.io/documents/en/lunescript/loop/">09. Repetition Syntax</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/func/">10. Functions</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/multipleretval/">10.2. Multi-value return values</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/defaultarg/">10.3. Omitting Arguments</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/arg/">10.4. Variadic Arguments and Return Values</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/closure/">10.5. Closures</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/error/">10.6. Error handling</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/nilable/">11. nilable</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/class1/">12. Class basics</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/class2accessor/">13. accessor</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classinherit/">14. Class Inheritance</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classadvertise/">15. Class advertise</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classoverride/">16. Class override</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/interface/">17. Interface</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classmapping/">18. mapping</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/generics/">19. generics</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/nilcond/">20. nil conditional operator</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/import/">21. import/provide</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/require/">22. require/module</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/glue/">22.1. Semi-automatic generation of glue code</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lua/">22.2. Linking with Lua</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/make/">23. Build</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/macro/">24. Macro</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/cast/">25. Cast</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/subfile/">26. subfile</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lazyloading/">27. Lazy Loading</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/shebang_main/">28. shebang and command line arguments</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/dir/">29. Recommended directory structure for projects using LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go/">80. Transcompiling to Go Language</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_package/">80.2 Packages when transpiling to Go</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_wasm/">80.4 WebAssembly support for LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/async/">81. Safe Asynchronous Processing</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/async_old/">81.1 Asynchronous processing (past information)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/luago/">82. Linking with Lua</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/ebnf/">A. BNF</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/onweb/">A. LuneScript running on a web browser</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/reason/">A. Reason for developing Lua transcompiler LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/recommend/">A. Recommendations for transcompiler development</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lnstags/">A. Tag jumping with lnstags (source code tagging system)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/completion/">A.Let&#39;s have more fun in a modern development environment</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/box/">Box edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lua_runtime/">Lua runtime when transpiling to 80.3 Go</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/test/">X. The Importance of Self-Hosting and Test Design in Language Development Quality Control</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/design/">Y.1 How to develop LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/design-2/">Y.2 Development of LuneScript (type information management)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/design-3/">Y.3 LuneScript Development (Scopes and Symbols)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_study/">Z. Transcompile to Go language (exploratory stage)</a></li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
