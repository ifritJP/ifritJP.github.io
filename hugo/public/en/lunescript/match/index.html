<!DOCTYPE html>
<html lang="ja-jp">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>06. match edition - tech</title>
<meta name="generator" content="Hugo 0.100.1" />
<link href="https://ifritjp.github.io/documentsindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://ifritjp.github.io/documents/en/lunescript/match/">
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/custom.css">
<script src="https://ifritjp.github.io/documents/js/bundle.js"></script>
<script src="https://ifritjp.github.io/documents/js/lnsSrcRun.js"></script>
<script src="https://ifritjp.github.io/documents/js/highlight_lns.js"></script>
<link rel="stylesheet" href="https://ifritjp.github.io/documents/css/highlight_lns.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script><style>
:root {}
</style>
<meta property="og:title" content="06. match edition" />
<meta property="og:description" content="LuneScript supports algebraic data types and pattern matching.
Algebraic data type (alge type) The enum type can limit the range by grouping int, real, or str values.
On the other hand, the algebraic data type is a more general version of the enum type, and all types can be grouped, not limited to int, real, and str.
Algebraic data types are declared with the alge keyword.
Here is an example:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ifritjp.github.io/documents/en/lunescript/match/" /><meta property="article:section" content="LuneScript" />

<meta property="og:site_name" content="tech" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="06. match edition"/>
<meta name="twitter:description" content="LuneScript supports algebraic data types and pattern matching.
Algebraic data type (alge type) The enum type can limit the range by grouping int, real, or str values.
On the other hand, the algebraic data type is a more general version of the enum type, and all types can be grouped, not limited to int, real, and str.
Algebraic data types are declared with the alge keyword.
Here is an example:"/>
<meta itemprop="name" content="06. match edition">
<meta itemprop="description" content="LuneScript supports algebraic data types and pattern matching.
Algebraic data type (alge type) The enum type can limit the range by grouping int, real, or str values.
On the other hand, the algebraic data type is a more general version of the enum type, and all types can be grouped, not limited to int, real, and str.
Algebraic data types are declared with the alge keyword.
Here is an example:">

<meta itemprop="wordCount" content="1091">
<meta itemprop="keywords" content="" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4708B8S6ES"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4708B8S6ES');
</script>
</head>
<body><div class="container"><header>
<h1>tech</h1>


[<a href="https://ifritjp.github.io/documents/en/">English</a>]

[<a href="https://ifritjp.github.io/documents/">Japanese</a>]

</header>
<div class="global-menu">
<nav>
<ul>
<li><a href="/documents/">Home</a></li>
<li><a href="https://ifritjp.github.io/blog2/public/">blog</a></li>
<li><a href="https://ifritjp.github.io/LuneScript-webFront/contents/">LuneScript on Web</a></li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>06. match edition</h1>

<p>
LuneScript supports algebraic data types and pattern matching.</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Algebraic data type (alge type)
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>
The enum type can limit the range by grouping int, real, or str values.</p>
<p>
On the other hand, the algebraic data type is a more general version of the enum type, and all types can be grouped, not limited to int, real, and str.</p>
<p>
Algebraic data types are declared with the alge keyword.</p>
<p>
Here is an example:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
class Hoge {
   pri let val:int {pub};
}
alge Test {
   Val1,
   Val2( int ),
   Val3( str ),
   Val4( Hoge ),
   Val5( num:int, txt:str ),
}</code></pre>
</div>
<p>
This example declares an alge type Test.</p>
<p>
Test has a range from Val1 to Val5. In addition, Val1 to Val5 each have the following parameters.</p>
<table>
<thead>
<tr>
<th>value</th>
<th>Parameters</th>
<th class="align-right"></th>
</tr>
</thead>
<tbody>
<tr>
<td>Val1</td>
<td>none</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Val2</td>
<td>int</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Val3</td>
<td>str</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Val4</td>
<td>Hoge</td>
<td class="align-right"></td>
</tr>
<tr>
<td>Val5</td>
<td>int, str</td>
<td class="align-right"></td>
</tr>
</tbody>
</table>
<p>
There are no restrictions on the parameter types. In this example, Val4 has a Hoge class type as a parameter.</p>
<p>
There is no limit to the number of parameters. In this example, Val5 has int and str as parameters.</p>
<p>
There are two ways to specify the parameter, one is to specify only the type, and the other is to specify the name and type. In this example, Val2 through Val4 specify only the type, and Val5 specifies the parameter name and type. The parameter name only has the effect of clarifying the meaning of that parameter.</p>
<p>
To use this alge type value, write:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: skip
let val1 = Test.Val1;
let val2 = Test.Val2( 1 );
let val3 = Test.Val3( &#34;abc&#34; );
let val4 = Test.Val4( new Hoge( 100 ) );
let val5 = Test.Val5( 10, &#34;xyz&#34; );</code></pre>
</div>
<p>
The meaning of each is as follows.</p>
<ul>
<li>val1 is Test.Val1</li>
<li>val2 has 1 as a parameter Test.Val2</li>
<li>val3 has &#34;abc&#34; as a parameter Test.Val3</li>
<li>val4 has new Hoge (100) as a parameter Test.Val4</li>
<li>val5 has 10, &#34;xyz&#34; as a parameter Test.Val5</li>
</ul>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
match
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>
The enum type can be used in the same way as the original value as follows:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
enum TestEnum {
  val0,
  val1,
  val2,
}
fn func( val:TestEnum ): int {
   return val + 100;
}
let val = 1;
func( unwrap TestEnum._from( val ) );</code></pre>
</div>
<p>
In this example, we have a TestEnum type value of +100 in the function <code class="verbatim">func()</code>, which indicates that the TestEnum type can also be used as an int number.</p>
<p>
On the other hand, alge type values require special processing. That process is match.</p>
<p>
The following is an example of match.</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
class Hoge {
   pri let val:int {pub};
}

alge Test {
   Val1,
   Val2( int ),
   Val3( str ),
   Val4( Hoge ),
   Val5( int, str ),
}

fn func( test:Test ) {
   match test {
      case .Val1 {
         print( test.$_txt );
      }
      case .Val2( x ) {
         print( test.$_txt, x );
      }
      case .Val3( x ) {
         print( test.$_txt, x );
      }
      case .Val4( x ) {
         print( test.$_txt, x.$val );
      }
      case .Val5( x, y ) {
         print( test.$_txt, x, y );
      }
   }
}

func( Test.Val1 ); // Test.Val1
func( Test.Val2( 1 ) ); // Test.Val2 1
func( Test.Val3( &#34;abc&#34; ) ); // Test.Val3 abc
func( Test.Val4( new Hoge( 100 ) ) ); // Test.Val4  100
func( Test.Val5( 10, &#34;xyz&#34; ) ); // Test.Val5 10 xyz</code></pre>
</div>
<p>
In this example, match is performed inside the <code class="verbatim">func()</code> function.</p>
<p>
In case, it branches from Val1 to Val5. Val2 to Val5 each declare a variable that receives a parameter.</p>
<p>
For example, func (Test.Val2 (1)) passes <code>Test.Val2( 1 )</code> to <code class="verbatim">func()</code>. Here it matches <code>case .Val2( x )</code> of match in <code class="verbatim">func()</code>. Then x is set to 1 and <code>print( test.$_txt, x )</code> is executed.</p>
<p>
Here <code>test.$_txt</code> expands the string &#34;Test.Val2&#34; that indicates Val2 in the range.</p>
<p>
match can use default, _default, and _match as well as switch.</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
abbreviation for alge type
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>
Like enum types, alge types can use abbreviations.</p>
<p>
If you have the following algae type Test and a function that takes that Test as an argument,</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
alge Test {
   Val1,
   Val2,
   Val3( int ),
}
fn func( test:Test ) {
   print( test );
}</code></pre>
</div>
<p>
When calling <code class="verbatim">func()</code>, Test can be omitted as follows:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: skip
func( .Val1 );
func( .Val2 );
func( .Val3( 10 ) );</code></pre>
</div>
<p>
If you want to omit the alge type defined in the external module, you need to import the external module.</p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
Alge type comparison
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>
Simple alge values with no parameters can be compared as follows:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: error
alge Test {
   Val1,
   Val2,
   Val3( int ),
}
fn func( test:Test ) {
   if test == .Val1 {
      print( &#34;Val1&#34; );
   }
   elseif test == .Val2 {
      print( &#34;Val2&#34; );
   }
   elseif test == .Val3(1) {  // error
      print( &#34;Val3&#34; );
   }
   else {
      print( &#34;no&#34; );
   }
}
func( .Val1 ); // Val1
func( .Val2 ); // Val2</code></pre>
</div>
<p>
Note that the values with parameters (Val3 in the above case) will be different even if the same parameters are given. By the way, the above <code>test == .Val3(1)</code> will result in an error. This is because the result of this expression will always be &#34;false&#34;, so a compile error will prevent unintended consequences at run time.</p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-2">
<h2 id="headline-5">
Example of using algae
</h2>
<div id="outline-text-headline-5" class="outline-text-2">
<p>
Using alge you can write the JSON structure as follows:</p>
<div class="src src-lns">
<pre tabindex="0"><code class="language-lns" data-lang="lns">// @lnsFront: ok
alge JsonVal {
   JNull,
   JBool(bool),
   JInt(int),
   JReal(real),
   JStr(str),
   JArray(List&lt;JsonVal&gt;),
   JObj(Map&lt;str,JsonVal&gt;),
}
fn dumpJson( stream:oStream, jval:JsonVal ) {
   match jval {
      case .JNull {
         stream.write( &#34;null&#34; );
      }
      case .JBool( val ) {
         stream.write( &#34;%s&#34; (val) );
      }     
      case .JInt( val ) {
         stream.write( &#34;%d&#34; (val ) );
      }        
      case .JReal( val ) {
         stream.write( &#34;%g&#34; (val ) );
      }        
      case .JStr( val ) {
         stream.write( &#39;&#34;%s&#34;&#39; (val ) );
      }        
      case .JArray( list ) {
         stream.write( &#34;[&#34; );
         foreach val, index in list {
            if index &gt; 1 {
               stream.write( &#34;,&#34; );
            }
            dumpJson( stream, val );
         }
         stream.write( &#34;]&#34; );
      }        
      case .JObj( map ) {
         stream.write( &#34;{&#34; );
         let mut cont = false;
         foreach val, key in map {
            if cont {
               stream.write( &#39;,&#39; );
            }
            else {
               cont = true;
            }
            stream.write( &#39;&#34;%s&#34;:&#39; (key) );
            dumpJson( stream, val );
         }
         stream.write( &#34;}&#34; );
      }
   }
}
dumpJson( io.stdout,
          JsonVal.JObj( { &#34;foo&#34;: JsonVal.JInt( 1 ),
                          &#34;bar&#34;: JsonVal.JStr( &#34;abc&#34; ) } ) );</code></pre>
</div>
<p>
You can do the same thing by using cast, inheritance, etc. without using algae. However, there are drawbacks to inheritance as well as casting.</p>
<p>
Alge isn&#39;t a panacea either, but I think it&#39;s a better option than using cast or inheritance in some situations.</p>
<p>
Next time, I will explain the interface.</p>
</div>
</div>
<div class="edit-meta">

<br></div><nav class="pagination"><a class="nav nav-prev-2" href="https://ifritjp.github.io/documents/en/lunescript/enum/" title="05. enum edition"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - 05. enum edition</a>
<a class="nav nav-next-2" href="https://ifritjp.github.io/documents/en/lunescript/variable/" title="07. Variables">Next - 07. Variables <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">

<nav class="slide-menu">
<ul>
<li class=""><a href="https://ifritjp.github.io/documents">Home</a></li>

<li class="parent has-sub-menu"><a href="https://ifritjp.github.io/documents/en/lunescript/">Making Lua easier with the transcompiler LuneScript !!<span class="mark opened">-</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tutorial2.setup/">01. Introduction</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/tutorial3.hello/">02. Hello world</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/crosscompile/">03. Cross-compiling between Lua versions</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/value/">04. Value</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/set/">04.2. Set</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/enum/">05. enum edition</a></li>
<li class="active"><a href="https://ifritjp.github.io/documents/en/lunescript/match/">06. match edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/variable/">07. Variables</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/branch/">08. General branch syntax</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/loop/">09. Repeated syntax</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/func/">10. Functions</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/multipleretval/">10.2. Multi-valued return value</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/defaultarg/">10.3. Omission of arguments</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/arg/">10.4. Variadic argument, return value</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/closure/">10.5. Closure</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/nilable/">11. nilable edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/class1/">12. Class Basics</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/class2accessor/">13. accessor edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classinherit/">14. Class inheritance</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classadvertise/">15. Class advertise</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classoverride/">16. Class override</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/interface/">17. Interface</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/classmapping/">18. mapping</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/generics/">19. generics edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/nilcond/">20. nil conditional operator edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/import/">21. import / provide</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/require/">22. require / module edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/glue/">22.1. Semi-automatic generation of glue code</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lua/">22.2. Cooperation with Lua</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/make/">23. Build</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/macro/">24. Macro edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/cast/">25. Cast edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/subfile/">26. subfile edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lazyloading/">27. Delayed loading</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/shebang_main/">28. shebang and command line arguments</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/dir/">29. Recommended directory structure for projects that use LuneScript</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go/">80. Transcompile to Go language</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_package/">80.2 Package when transcompiling to Go language</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lua_runtime/">80.3 Lua runtime when transcompiled to Go</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/async/">81. Safe asynchronous processing</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/async_old/">81.1 Asynchronous processing O (past information)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/luago/">82. Collaboration with Lua</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/completion/">A. Let&#39;s have more fun in an exciting development environment</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/onweb/">A. LuneScript running on a web browser</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/lnstags/">A. Tag jump by lnstags (source code tag system)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/recommend/">A. Transcompiler development recommendations</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/reason/">A. Why Lua&#39;s transcompiler LuneScript was developed</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/box/">Box edition</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/go_study/">Transcompile to Z. Go language (under consideration)</a></li>
<li class=""><a href="https://ifritjp.github.io/documents/en/lunescript/test/">X. Importance of self-hosting and test design in quality control of language development</a></li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
